# GOM representative 2D mesh
reset
${Units('si')}


#################### GEOMETRY#####################################################
############# 	boundaries		##############################
create vertex x { 0*m} y {0*m}
${idtopleft=Id("vertex")}
create vertex x { 45000*m} y {0*m}
${idtopright=Id("vertex")}
create vertex x { 45000*m} y { -8000.0*m}
${idbotright=Id("vertex")}
create vertex x { 0*m} y { -8000.0*m}
${idbotleft=Id("vertex")}

create surface vertex all 

##################               Faults and Layers           #######################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario21_faultsAndLayers.jou'

##################                Subdivide Amph B          #######################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario21_layeringAmph.jou'


############### 		SPLIT     	###############################
#split CTl_fault crossing Mio_top_left Amphb_top_left fault_div_amphbtr  Amphb_bot_left fault_div_amphbbr Marga_top_left fault_div_bot #LM1_bot_left
split CTl_fault crossing Mio_top_left Amphb_top_left fault_div_amphbbr Marga_top_left 
#split CT_fault crossing curve Mio_top_mid fault_div_amphbtl Amphb_top_mid fault_div_amphbbl Amphb_bot_mid fault_div_margatl Marga_top_mid Marga_bot_left Marga_bot_mid LM1_bot_left S_fault
split CT_fault crossing curve Mio_top_mid fault_div_amphbtl Amphb_bot_mid fault_div_margatl Marga_top_mid Marga_bot_left Marga_bot_mid LM1_bot_left S_fault
split S_fault crossing curve Mio_top_mid Mio_top_right Amphb_top_mid Amphb_top_right Amphb_bot_mid Amphb_bot_right Marga_top_mid Marga_top_right Marga_bot_mid Marga_bot_right LM1_bot_right

############### correct thickness of CT fault at the top ######################
delete curve CTl_fault CT_fault
create vertex x { 11500.8610306891*m} y { 0*m}
${idCT_top=Id("vertex")}
create vertex x { 11742.472500*m} y {-547.852822*m}
${idmiotr=Id("vertex")}
create curve vertex {idCT_top} to {idmiotr}
curve {Id("curve")} name "CT_fault"

create vertex x { 11493*m} y { 0*m}
${idCTl_top=Id("vertex")}
create vertex x {11731.210539*m} y {-547.707464*m}
${idmiotl=Id("vertex")}
create curve vertex {idCTl_top} to {idmiotl}
curve {Id("curve")} name "CTl_fault"

############### division line for grid refinement within LM2 ######################
#create vertex x { 14153.2374059062*m} y { -2773.54408410195*m}
create vertex x { 13653.2374059062*m} y { -2473.54408410195*m}
${idCT_divRef1=Id("vertex")}
create vertex x { 15265.3445280834*m} y { -1948.22969354359*m}
${id_divRef2=Id("vertex")}
create curve vertex {idCT_divRef1} to {id_divRef2}
curve {Id("curve")} name "GridRefine"

################ division line for grid refinement within LM2 (left) ######################
create vertex x {13280*m} y { -2259.909259*m}
${idCT_divRefl1=Id("vertex")}
create vertex x {11500*m} y {-1870.013197982274*m}
${id_divRefl2=Id("vertex")}
create curve vertex {idCT_divRefl1} to {id_divRefl2}
curve {Id("curve")} name "GridRefine"

#########################  MERGE ##################################3
imprint surface 1 with curve all
#Merge Tolerance 0.1
merge all

# delete free vertices
delete free vertex all

#delete free curves 
#delete free Amphb_bot_mid
#delete free CT_fault@E
#delete free Amphb_bot_left
#delete free CTl_fault@E
delete free curve all
	

###############################		MESH		##########################################
surface all scheme triMesh

# fault surfaces -- mesh size for 2 layers
surface 4 size 4.5
surface 42 size 6
#surface 41 size 10
#surface 23 size 10
surface 19 size 9.8
surface 40 size 15

# amph b subdivided interval
surface 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 41 size 25   # HW
surface 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 size 25    # FW

# amph b rest
 surface 15 67 size 200      # right and left of refined
surface 12 size 400             # far right

# reservoir
surface 3 43 size 50         # reservoir ref (FW and HW)
surface 13 size 100       # reservoir mid
surface 2 size 200       # reservoir left
surface 10 size 300       # reservoir (far) right

# other
surface 16 65 size 200       ## MMUM HW and FW
surface 5 6 7 8 9 11 14 17 18 66 size 800

#Set Developer Commands on
#Trimesher Remove Tiny Edge Length {2*m} off
mesh surface all

# improve mesh quality by smoothing
#surface all smooth scheme condition number beta 1.5 cpu 10
#smooth surface all	
	
###############################	 	MATERIAL BLOCKS		##################################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario21_blocks.jou'


###############################	NODESETS FOR FAULT AND BOUNDARIES		###########################

group "topboundary" add node in curve 112 115 297
nodeset 2 group topboundary 
nodeset 2 name "topboundary"

group "leftboundary" add node in curve  106 122 177 179 294 296 298
nodeset 3 group leftboundary 
nodeset 3 name "leftboundary"

group "rightboundary" add node in curve 116 121 128 132 138 145 151  
nodeset 4 group rightboundary 
nodeset 4 name "rightboundary"

group "bottomboundary" add node in curve 3
nodeset 5 group bottomboundary 
nodeset 5 name "bottomboundary"

group "fault_CT" add node in curve CT_fault CT_fault@A 175 182 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 109 148 CT_fault@D CT_fault@E CT_fault@F CT_fault@G CT_fault@H CT_fault@I
nodeset 6 group fault_CT
nodeset 6 name "fault_CT"

group "fault_S" add node in curve S_fault@I S_fault@H S_fault@G S_fault@F S_fault@E S_fault@D S_fault@C S_fault@B S_fault@A S_fault
nodeset 7 group fault_S
nodeset 7 name "fault_S"

export mesh "/home/lluis/gom_mz_tri_s21.exo" dimension 2 overwrite  #27735 els











