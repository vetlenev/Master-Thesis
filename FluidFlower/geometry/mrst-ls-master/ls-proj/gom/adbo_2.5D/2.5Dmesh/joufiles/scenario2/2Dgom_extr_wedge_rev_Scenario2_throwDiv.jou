# GOM representative 2D mesh
reset
${Units('si')}


#################### GEOMETRY#####################################################
############# 	boundaries		##############################
create vertex x { 0*m} y {0*m}
${idtopleft=Id("vertex")}
create vertex x { 45000*m} y {0*m}
${idtopright=Id("vertex")}
create vertex x { 45000*m} y { -8000.0*m}
${idbotright=Id("vertex")}
create vertex x { 0*m} y { -8000.0*m}
${idbotleft=Id("vertex")}

create surface vertex all 

##################               Faults and Layers           #######################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario2/scenario21_faultsAndLayers.jou'

##################                Subdivide Amph B          #######################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario2/scenario21_layeringAmph.jou'


############### 		SPLIT     	###############################
#split CTl_fault crossing Mio_top_left Amphb_top_left fault_div_amphbtr  Amphb_bot_left fault_div_amphbbr Marga_top_left fault_div_bot #LM1_bot_left
split CTl_fault crossing Mio_top_left Amphb_top_left fault_div_amphbbr Marga_top_left 
#split CT_fault crossing curve Mio_top_mid fault_div_amphbtl Amphb_top_mid fault_div_amphbbl Amphb_bot_mid fault_div_margatl Marga_top_mid Marga_bot_left Marga_bot_mid LM1_bot_left S_fault
split CT_fault crossing curve Mio_top_mid fault_div_amphbtl Amphb_bot_mid fault_div_margatl Marga_top_mid Marga_bot_left Marga_bot_mid LM1_bot_left S_fault
split S_fault crossing curve Mio_top_mid Mio_top_right Amphb_top_mid Amphb_top_right Amphb_bot_mid Amphb_bot_right Marga_top_mid Marga_top_right Marga_bot_mid Marga_bot_right LM1_bot_right

############### correct thickness of CT fault at the top ######################
delete curve CTl_fault CT_fault
create vertex x { 11500.8610306891*m} y { 0*m}
${idCT_top=Id("vertex")}
create vertex x { 11742.472500*m} y {-547.852822*m}
${idmiotr=Id("vertex")}
create curve vertex {idCT_top} to {idmiotr}
curve {Id("curve")} name "CT_fault"

create vertex x { 11493*m} y { 0*m}
${idCTl_top=Id("vertex")}
create vertex x {11731.210539*m} y {-547.707464*m}
${idmiotl=Id("vertex")}
create curve vertex {idCTl_top} to {idmiotl}
curve {Id("curve")} name "CTl_fault"

############### add CT fault throw subdivisions within Amph B ######################
create vertex x {12343.803443*m} y { -1451.303729*m}
${idlt1=Id("vertex")}
create vertex x { 12370.6797915460*m} y { -1450.27967866706*m}
${idrt1=Id("vertex")}
create curve vertex {idlt1} to {idrt1}
curve {Id("curve")} name "t1div"

create vertex x {12446.6414018949*m} y { -1551.303729*m}
${idlt2=Id("vertex")}
create vertex x { 12466.8132727638*m} y { -1546.60613766706*m}
${idrt2=Id("vertex")}
create curve vertex {idlt2} to {idrt2}
curve {Id("curve")} name "t2div"

create vertex x {12549.4793607899*m} y { -1651.303729*m}
${idlt3=Id("vertex")}
create vertex x { 12570} y { -1650*m}                                                          	
${idrt3=Id("vertex")}
create curve vertex {idlt3} to {idrt3}
curve {Id("curve")} name "t3div"

create vertex x { 12676.2808877167} y { -1750*m}                                                          	
${idlt4=Id("vertex")}
create vertex x {12652.3173196848*m} y { -1751.303729*m}
${idrt4=Id("vertex")}
create curve vertex {idlt4} to {idrt4}
curve {Id("curve")} name "t4div"

create vertex x {12755.1552785797*m} y { -1851.303729*m}
${idlt5=Id("vertex")}
create vertex x { 12782.5617754334} y { -1850*m}                                                          	
${idrt5=Id("vertex")}
create curve vertex {idlt5} to {idrt5}
curve {Id("curve")} name "t5div"

############### division line for grid refinement within LM2 ######################
#create vertex x { 14153.2374059062*m} y { -2773.54408410195*m}
create vertex x { 13653.2374059062*m} y { -2473.54408410195*m}
${idCT_divRef1=Id("vertex")}
create vertex x { 15265.3445280834*m} y { -1948.22969354359*m}
${id_divRef2=Id("vertex")}
create curve vertex {idCT_divRef1} to {id_divRef2}
curve {Id("curve")} name "GridRefine"

################ division line for grid refinement within LM2 (left) ######################
create vertex x {13280*m} y { -2259.909259*m}
${idCT_divRefl1=Id("vertex")}
create vertex x {11500*m} y {-1870.013197982274*m}
${id_divRefl2=Id("vertex")}
create curve vertex {idCT_divRefl1} to {id_divRefl2}
curve {Id("curve")} name "GridRefine"

#########################  MERGE ##################################3
imprint surface 1 with curve all
#Merge Tolerance 0.1
merge all

# delete free vertices
delete free vertex all

#delete free curves 
#delete free Amphb_bot_mid
#delete free CT_fault@E
#delete free Amphb_bot_left
#delete free CTl_fault@E
delete free curve all
	

###############################		MESH		##########################################
surface all scheme triMesh

# fault surfaces -- mesh size for 2 layers
surface 9 size 10
surface 47 size 6
#surface 41 size 10
#surface 23 size 10
surface 4 6 7 8 24 size 9.8
surface 5 size 12
surface 45 size 15

# amph b subdivided interval
surface 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 46 size 25   # HW
surface 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 size 25    # FW

# amph b rest
 surface 20 72 size 200      # right and left of refined
surface 17 size 400             # far right

# reservoir
surface 3 48 size 50         # reservoir ref (FW and HW)
surface 18 size 100       # reservoir mid
surface 2 size 200       # reservoir left
surface 15 size 300       # reservoir (far) right

# other
surface 21 70 size 200       ## MMUM HW and FW
surface  10 11 12 13 14 16 19 22 23 71  size 800

#Set Developer Commands on
#Trimesher Remove Tiny Edge Length {2*m} off
mesh surface all

# improve mesh quality by smoothing
#surface all smooth scheme condition number beta 1.5 cpu 10
#smooth surface all	
	
###############################	 	MATERIAL BLOCKS		##################################
playback '/home/lluis/matlab/mrst-dev/mrst-ls/ls-proj/gom/adbo_2.5D/2.5Dmesh/joufiles/scenario2/scenario2_throwDiv_blocks.jou'


###############################	NODESETS FOR FAULT AND BOUNDARIES		###########################

group "topboundary" add node in curve 160 163 307
nodeset 2 group topboundary 
nodeset 2 name "topboundary"

group "leftboundary" add node in curve  111 170 224 226 304 306 308
nodeset 3 group leftboundary 
nodeset 3 name "leftboundary"

group "rightboundary" add node in curve 164 169 176 180 186 193 199 
nodeset 4 group rightboundary 
nodeset 4 name "rightboundary"

group "bottomboundary" add node in curve 3
nodeset 5 group bottomboundary 
nodeset 5 name "bottomboundary"

group "fault_CT" add node in curve CT_fault CT_fault@A 114 122 123 124 125 126 127 128 129 130 140 141 142 143 149 150 151 152 158 196 233 234 235 236 CT_fault@D CT_fault@E CT_fault@F CT_fault@G CT_fault@H CT_fault@I
nodeset 6 group fault_CT
nodeset 6 name "fault_CT"

group "fault_S" add node in curve S_fault@I S_fault@H S_fault@G S_fault@F S_fault@E S_fault@D S_fault@C S_fault@B S_fault@A S_fault
nodeset 7 group fault_S
nodeset 7 name "fault_S"

export mesh "/home/lluis/gom_mz_tri_s2_throwDiv.exo" dimension 2 overwrite  #27735 els













