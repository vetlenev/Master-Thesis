# GOM representative 2D mesh
reset
${Units('si')}

#################### GEOMETRY#####################################################
############# 	boundaries		##############################
create vertex x { 0*m} y {0*m}
${idtopleft=Id("vertex")}
create vertex x { 45000*m} y {0*m}
${idtopright=Id("vertex")}
create vertex x { 45000*m} y { -8000.0*m}
${idbotright=Id("vertex")}
create vertex x { 0*m} y { -8000.0*m}
${idbotleft=Id("vertex")}

create surface vertex all 

###########	 CT fault     		###############################
create vertex x { 11500.8610306891*m} y { 0*m}
${idCT_top=Id("vertex")}
create vertex x { 11742.4724956572*m} y { -547.852821580879*m}
${idCT_topmiol=Id("vertex")}
#create vertex x { 11762.0150550087*m} y { -582.763066547654*m}
#${idCT_topmior=Id("vertex")}

#create vertex x { 11962.554057*m} y { -979.754881*m}
create vertex x { 12277.9386218877*m} y { -1352.37528513339*m}
${idCT_topamphbl=Id("vertex")}
create vertex x { 12388.6797915460*m} y { -1450.27967866706*m}
${idCT_topamphbr=Id("vertex")}
create vertex x { 12805.5877243775*m} y { -1871.66517901418*m}
${idCT_botamphbl=Id("vertex")}
create vertex x { 12920.2374059062*m} y { -1973.54408410195*m}
${idCT_botamphbr=Id("vertex")}

create vertex x { 13203.2374059062*m} y { -2173.54408410195*m}
create vertex x { 13653.2374059062*m} y { -2473.54408410195*m}
create vertex x { 14153.2374059062*m} y { -2773.54408410195*m}

create vertex x { 14586.5662999421*m} y { -2988.39631062184*m}
${idCT_topmargal=Id("vertex")}
create vertex x { 15007.3827446439*m} y { -3169.69156005157*m}
${idCT_topmargar=Id("vertex")}
create vertex x { 15112.9125651419*m} y { -3212.53595160171*m}
${idCT_botmargal=Id("vertex")}
create vertex x { 16127.8228141285*m} y { -3554.49766934444*m}
${idCT_botmargar=Id("vertex")}

create vertex x { 17669.0793283150*m} y { -4014.67817117921*m}
${idCT_botLM1=Id("vertex")}
create vertex x { 18426.0277938622*m} y { -4195.18000595061*m}
create vertex x { 19593.3700057904*m} y { -4434.39452543886*m}
create vertex x { 20398.5234510712*m} y { -4574.43221263513*m}
create vertex x { 21796.4678633468*m} y { -4760.88465734404*m}
create vertex x { 22965.1129125651*m} y { -4883.46722205693*m}
create vertex x { 24017.8054429647*m} y { -4941.78319944461*m}
create vertex x { 25204.6902142444*m} y { -5000.09917683229*m}
create vertex x { 26718.5871453387*m} y { -5052.46454428246*m}
create vertex x { 27809.0619571511*m} y { -5056.43161757414*m}
create vertex x { 29035.0318471338*m} y { -5104.82991173262*m}
create vertex x { 30318.3265778807*m} y { -5163.14588912030*m}
create vertex x { 31410.1042269832*m} y { -5209.95735396211*m}
create vertex x { 31927.3306311523*m} y { -5240.90052563721*m}
create vertex x { 33477.7070063694*m} y { -5314.68808886244*m}
create vertex x { 35029.3862188767*m} y { -5396.40979867103*m}
create vertex x { 36676.1725535611*m} y { -5478.13150847962*m}
${idCT_bot=Id("vertex")}

create curve spline vertex {idCT_top} to {idCT_bot}
curve {Id("curve")} name "CT_fault"

###########	 copy CT fault (left)     		###############################
create curve offset curve CT_fault distance 50 direction x
create curve offset curve CT_fault distance 20 direction x
create curve offset curve CT_fault distance 10 direction x

########### 		create the actual CTl_fault 		###############
create vertex x { 11489.762261*m} y { 0*m}
${idCTl_top=Id("vertex")}
create vertex on curve CT_fault@C fraction 0 from vertex 39
create vertex on curve CT_fault@C fraction 0.0222 from vertex 39
#create vertex on curve CT_fault@C fraction 0.0305 from vertex 39
create vertex x {11835*m} y { -747.232435*m}
#create vertex on curve CT_fault@C fraction 0.0405 from vertex 39
create vertex x {11954*m} y {-979.754881*m}
#create vertex on curve CT_fault@C fraction 0.045 from vertex 39
create vertex x {12035*m} y { -1080.021967*m}
# create vertex on curve CT_fault@C fraction 0.05 from vertex 39
create vertex x {12120*m} y { -1186.891153*m}
create vertex on curve CT_fault@C fraction 0.05845 from vertex 39
create vertex on curve CT_fault@C fraction 0.0639 from vertex 39
#create vertex on curve CT_fault@C fraction 0.07 from vertex 39
create vertex x {12483*m} y { -1562.226812*m}
create vertex on curve CT_fault@C fraction 0.08 from vertex 39
create vertex x {12790*m} y { -1871.809575*m}
#create vertex on curve CT_fault@C fraction 0.0919 from vertex 39 
create vertex x {12904*m} y { -1975.517705*m}
#create vertex on curve CT_fault@C fraction 0.12 from vertex 39 
create vertex x { 13183*m} y { -2173.54408410195*m}
create vertex x {13510*m} y {-2402.140420*m}
create vertex x { 13615.2374059062*m} y { -2473.54408410195*m}
create vertex x { 14115*m} y { -2773.54408410195*m}
#create vertex on curve CT_fault@C fraction 0.15 from vertex 39 
create vertex x {14209*m} y {-2817.347489*m}
#create vertex on curve CT_fault@C fraction 0.1646 from vertex 39 
create vertex x {14556*m} y {-2989.505406*m}
create vertex on curve CT_fault@B fraction 0.181 from vertex 37
create vertex on curve CT_fault@B fraction 0.1853 from vertex 37
#create vertex x {15055*m} y {-3214.993297*m}
#create vertex on curve CT_fault@B fraction 0.224 from vertex 37
#create vertex x {16015*m} y {-3550.080422*m}
#create vertex on curve CT_fault@B fraction 0.25 from vertex 37
#create vertex x {16660*m} y {-3757.626801*m}
#create vertex on curve CT_fault@B fraction 0.265 from vertex 37
#create vertex x {17030*m} y {-3874.492486*m}
#create vertex on curve CT_fault@A fraction 0.2807  from vertex 35 #
#create vertex on curve CT_fault@A fraction 0.3 from vertex 35
#create vertex on curve CT_fault@A fraction 0.32 from vertex 35
#create vertex on curve CT_fault@A fraction 0.35  from vertex 35
#create vertex on curve CT_fault@A fraction 0.375 from vertex 35
#create vertex on curve CT_fault@A fraction 0.4 from vertex 35
#create vertex on curve CT_fault@A fraction 0.425 from vertex 35
#create vertex on curve CT_fault@A fraction 0.45  from vertex 35
#create vertex on curve CT_fault@A fraction 0.475 from vertex 35
#create vertex on curve CT_fault@A fraction 0.5 from vertex 35
#create vertex on curve CT_fault@A fraction 0.525 from vertex 35
#create vertex on curve CT_fault@A fraction 0.55  from vertex 35
#create vertex on curve CT_fault@A fraction 0.6   from vertex 35
#create vertex on curve CT_fault@A fraction 0.65  from vertex 35
#create vertex on curve CT_fault@A fraction 0.7 from vertex 35
#create vertex on curve CT_fault@A fraction 0.75  from vertex 35
#create vertex on curve CT_fault@A fraction 0.85  from vertex 35
#create vertex on curve CT_fault@A fraction 0.95  from vertex 35
#create vertex on curve CT_fault@A fraction 0.99  from vertex 35
#create vertex x { 36676.1725535611*m} y { -5478.13150847962*m}
${idCTl_bot=Id("vertex")}

delete curve CT_fault@A CT_fault@B CT_fault@C
create curve spline vertex {idCTl_top} to {idCTl_bot}
curve {Id("curve")} name "CTl_fault"

################## 	Synthetic  fault 	########################
#create vertex x { 25990.3011001737*m} y { -524.447089159972*m}
#${idS_top=Id("vertex")}
create vertex x { 26056.7458019687*m} y { -606.168798968561*m}
${idS_topmiol=Id("vertex")}
#create vertex x { 26076.2883613202*m} y { -626.400872756124*m}
#${idS_topmior=Id("vertex")}

create vertex x { 26593.5147654893*m} y { -1623.72309828424*m}
${idS_topamphbl=Id("vertex")}
create vertex x { 26650.8396062536*m} y { -1705.44480809283*m}
${idS_topamphbr=Id("vertex")}
create vertex x { 27071.6560509554*m} y { -2200.93226222354*m}
${idS_botamphbl=Id("vertex")}
create vertex x { 27350.4632310365*m} y { -2466.32946543687*m}
${idS_botamphbr=Id("vertex")}

create vertex x { 27570.6427330631*m} y { -2635.32678766240*m}
${idS_topmargal=Id("vertex")}
create vertex x { 27742.6172553561*m} y { -2757.90935237528*m}
${idS_topmargar=Id("vertex")}
create vertex x { 27848.1470758541*m} y { -2842.40801348805*m}
${idS_botmargal=Id("vertex")}
create vertex x { 28000.5790387956*m} y { -2958.64326093425*m}
${idS_botmargar=Id("vertex")}

create vertex x { 29012.8836132021*m} y { -3757.61182187841*m}
${idS_botLM1=Id("vertex")}
create vertex x { 29600.4632310365*m} y { -4241.99147079242*m}
create vertex x { 29949.6236247829*m} y { -4441.53525736388*m}
create vertex x { 30236.2478286045*m} y { -4610.92928691858*m}
create vertex x { 30638.8245512449*m} y { -4795.79490231082*m}
create vertex x { 30969.7452229299*m} y { -4925.51819894873*m}
create vertex x { 31453.0978575565*m} y { -5088.96161856590*m}
create vertex x { 31927.3306311523*m} y { -5240.90052563721*m}
${idS_bot=Id("vertex")}	

create curve spline vertex {idS_topmiol} to {idS_bot}
curve {Id("curve")} name "S_fault"

################## 	Top Miocene 	#######################
create vertex x { 0*m} y { -542.298918972528*m}
${idMiotl_l=Id("vertex")}
create vertex x { 11731.446850*m} y { -547.919750*m}
${idMiotl_r=Id("vertex")}
create vertex x { 11742.4724956572*m} y { -547.852821580879*m}
${idMiotm_l=Id("vertex")}
create vertex x { 26056.7458019687*m} y { -606.168798968561*m}
${idMiotm_r=Id("vertex")}
#create vertex x { 26076.2883613202*m} y { -626.400872756124*m}
#${idMiotr_l=Id("vertex")}
create vertex x { 45000*m} y { -687.493801447981*m}
${idMiotr_r=Id("vertex")}

create vertex x { 0*m} y { -542.298918972528*m}
${idextraleft=Id("vertex")}
create vertex x { 11731.446850*m} y { -547.919750*m}
${idextraright=Id("vertex")}
create curve vertex {idextraleft} to {idextraright}
curve {Id("curve")} name "Mio_top_left"

create curve vertex {idMiotl_l} to {idMiotl_r}
curve {Id("curve")} name "extramio"
create curve vertex {idMiotm_l} to {idMiotm_r}
curve {Id("curve")} name "Mio_top_mid"
create curve vertex {idMiotm_r} to {idMiotr_r}
curve {Id("curve")} name "Mio_top_right"		
		
################## 	Top Amph B 	#######################
create vertex x { 0*m} y { -1352.37528513339*m}
${idAmphtl_l=Id("vertex")}
create vertex x { 12263.692740*m} y { -1352.787363*m}
${idAmphtl_r=Id("vertex")}

create vertex x { 12388.6797915460*m} y { -1450.27967866706*m}
${idAmphtm_l=Id("vertex")}
create vertex x { 12868.1239143023*m} y { -1416.24516512943*m}
create vertex x { 13480.4574406485*m} y { -1412.27809183775*m}
create vertex x { 14030.2547770701*m} y { -1416.64187245859*m}
create vertex x { 14514.9102489867*m} y { -1435.68382425865*m}
create vertex x { 15505.0665894615*m} y { -1485.27224040464*m}
create vertex x { 16591.6328894036*m} y { -1534.86065655063*m}
create vertex x { 16856.1088592936*m} y { -1533.27382723396*m}
create vertex x { 17908.8013896931*m} y { -1547.95199841317*m}
create vertex x { 19143.8911407064*m} y { -1568.18407220073*m}
create vertex x { 21059.0619571511*m} y { -1603.49102449668*m}
create vertex x { 21882.4551244933*m} y { -1612.21858573837*m}
create vertex x { 24621.0191082803*m} y { -1617.77248834672*m}
create vertex x { 26593.5147654893*m} y { -1623.72309828424*m}
${idAmphtm_r=Id("vertex")}

create vertex x { 26650.8396062536*m} y { -1705.44480809283*m}
${idAmphtr_l=Id("vertex")}
create vertex x { 28748.4076433121*m} y { -1652.68273331350*m}
create vertex x { 29724.2327735958*m} y { -1647.12883070515*m}
create vertex x { 31064.8523451071*m} y { -1652.68273331350*m}
create vertex x { 34340.1852924146*m} y { -1699.49419815531*m}
create vertex x { 39414.7365373480*m} y { -1740.35505305961*m}
create vertex x { 45000*m} y { -1769.31468808886*m}
${idAmphtr_r=Id("vertex")}	

create curve vertex {idAmphtl_l} to {idAmphtl_r}
curve {Id("curve")} name "Amphb_top_left"
create curve spline vertex {idAmphtm_l} to {idAmphtm_r}
curve {Id("curve")} name "Amphb_top_mid"
create curve spline vertex {idAmphtr_l} to {idAmphtr_r}
curve {Id("curve")} name "Amphb_top_right"

################## 	Bot Amph B 	#######################
create vertex x { 0*m} y { -1856.98700783497*m}
${idAmphbl_l=Id("vertex")}
create vertex x {12790.000000*m} y {-1871.809575*m}
${idAmphbl_r=Id("vertex")}

create vertex x { 12920.2374059062*m} y { -1973.54408410195*m}
${idAmphbm_l=Id("vertex")}
create vertex x { 13287.6375217140*m} y { -1906.97213131013*m}
create vertex x { 13870.0057903880*m} y { -1888.72359416840*m}
create vertex x { 14628.2570932252*m} y { -1921.65030248934*m}
create vertex x { 15265.3445280834*m} y { -1948.22969354359*m}
create vertex x { 15718.7319050376*m} y { -1970.84201130616*m}
create vertex x { 16504.3427909670*m} y { -2016.46335416047*m}
create vertex x { 16930.3705848292*m} y { -2026.77774471883*m}
create vertex x { 19069.6294151708*m} y { -2072.00238024397*m}
create vertex x { 22008.8303416329*m} y { -2121.59079638996*m}
create vertex x { 24743.4858135495*m} y { -2162.84835862343*m}
create vertex x { 27071.6560509554*m} y { -2200.93226222354*m}
${idAmphbm_r=Id("vertex")}

create vertex x { 27350.4632310365*m} y { -2466.32946543687*m}
${idAmphbr_l=Id("vertex")}
create vertex x { 28077.4464389114*m} y { -2375.88019438659*m}
create vertex x { 29380.2837290098*m} y { -2369.92958444907*m}
create vertex x { 31141.7197452229*m} y { -2410.79043935337*m}
create vertex x { 32731.1812391430*m} y { -2451.65129425766*m}
create vertex x { 35106.2536189925*m} y { -2498.46275909947*m}
create vertex x { 38362.0440069485*m} y { -2515.91788158286*m}
create vertex x { 42498.5524030110*m} y { -2556.77873648716*m}
create vertex x { 45000*m} y { -2562.72934642468*m}
${idAmphbr_r=Id("vertex")}	

create curve vertex {idAmphbl_l} to {idAmphbl_r}
curve {Id("curve")} name "Amphb_bot_left"
create curve spline vertex {idAmphbm_l} to {idAmphbm_r}
curve {Id("curve")} name "Amphb_bot_mid"
create curve spline vertex {idAmphbr_l} to {idAmphbr_r}
curve {Id("curve")} name "Amphb_bot_right"

################## 	Top Marg A		#######################
create vertex x { 0*m} y { -2988.39631062184*m}
${idMargatl_l=Id("vertex")}
create vertex x { 14556.000000*m} y { -2989.505406*m}
${idMargatl_r=Id("vertex")}

create vertex x { 15007.3827446439*m} y { -3169.69156005157*m}
${idMargatm_l=Id("vertex")}
create vertex x { 15420.3821656051*m} y { -3061.78716651790*m}
create vertex x { 16368.8477127968*m} y { -2911.03838143410*m}
create vertex x { 16930.3705848292*m} y { -2878.11167311316*m}
create vertex x { 17512.7388535032*m} y { -2878.11167311316*m}
create vertex x { 18414.3022582513*m} y { -2919.36923534662*m}
create vertex x { 18921.1059640996*m} y { -2919.36923534662*m}
create vertex x { 19455.2692530400*m} y { -2943.96508975503*m}
create vertex x { 20776.3462651998*m} y { -2943.96508975503*m}
create vertex x { 21358.7145338738*m} y { -2946.34533373004*m}
create vertex x { 22434.8581354951*m} y { -2888.42606367153*m}
create vertex x { 23430.2258251303*m} y { -2824.55618367549*m}
create vertex x { 24925.8830341633*m} y { -2733.71020529604*m}
create vertex x { 25887.3769542559*m} y { -2696.81642368343*m}
create vertex x { 26924.4354371743*m} y { -2659.52593474164*m}
create vertex x { 27570.6427330631*m} y { -2635.32678766240*m}
${idMargatm_r=Id("vertex")}


create vertex x { 27742.6172553561*m} y { -2757.90935237528*m}
${idMargatr_l=Id("vertex")}
create vertex x { 28039.6641574985*m} y { -2684.91520380839*m}
create vertex x { 28360.1621308628*m} y { -2642.86422691659*m}
create vertex x { 28766.6473653735*m} y { -2648.41812952494*m}
create vertex x { 29427.1858714534*m} y { -2657.14569076664*m}
create vertex x { 30313.1152287203*m} y { -2698.00654567093*m}
create vertex x { 31012.7388535032*m} y { -2736.09044927105*m}
create vertex x { 32041.9803126810*m} y { -2789.64593870872*m}
create vertex x { 34114.7944412276*m} y { -2863.83020926312*m}
create vertex x { 35631.2970469021*m} y { -2880.09520975900*m}
create vertex x { 36984.9449913144*m} y { -2900.72399087573*m}
create vertex x { 40275.9119861031*m} y { -2913.02191807994*m}
create vertex x { 45000*m} y { -2950.31240702172*m}
${idMargatr_r=Id("vertex")}

create curve vertex {idMargatl_l} to {idMargatl_r}
curve {Id("curve")} name "Marga_top_left"
create curve spline vertex {idMargatm_l} to {idMargatm_r}
curve {Id("curve")} name "Marga_top_mid"
create curve spline vertex {idMargatr_l} to {idMargatr_r}
curve {Id("curve")} name "Marga_top_right"	

################## 	Bot Marg A		#######################	
create vertex x { 0*m} y { -3212.53595160171*m}
${idMargabl_l=Id("vertex")}
create vertex x {15065.360997*m} y { -3214.993297*m}
${idMargabl_r=Id("vertex")}

create vertex x { 16127.8228141285*m} y { -3554.49766934444*m}
${idMargabm_l=Id("vertex")}
create vertex x { 16456.1378112334*m} y { -3434.69205593573*m}
create vertex x { 16828.7492762015*m} y { -3339.87900426460*m}
create vertex x { 17153.1557614360*m} y { -3308.93583258951*m}
create vertex x { 17566.1551823972*m} y { -3302.98522265199*m}
create vertex x { 18304.8639258830*m} y { -3310.91936923535*m}
create vertex x { 18839.0272148234*m} y { -3319.25022314787*m}
create vertex x { 19800.5211349160*m} y { -3306.95229594367*m}
create vertex x { 20762.0150550087*m} y { -3300.60497867698*m}
create vertex x { 21405.6166763173*m} y { -3279.97619756025*m}
create vertex x { 21933.2657788072*m} y { -3253.39680650600*m}
create vertex x { 22367.1105964100*m} y { -3230.78448874343*m}
create vertex x { 23051.1001737116*m} y { -3179.21253595160*m}
create vertex x { 24167.6317313260*m} y { -3098.68094813052*m}
create vertex x { 25346.6994788651*m} y { -2995.53704254686*m}
create vertex x { 26293.8621887666*m} y { -2939.99801646335*m}
create vertex x { 27168.0660104227*m} y { -2888.42606367153*m}
create vertex x { 27848.1470758541*m} y { -2842.40801348805*m}
${idMargabm_r=Id("vertex")}

create vertex x { 28000.5790387956*m} y { -2958.64326093425*m}
${idMargabr_l=Id("vertex")}
create vertex x { 28284.5975680371*m} y { -2890.40960031737*m}
create vertex x { 28602.4898668211*m} y { -2851.53228205891*m}
create vertex x { 29137.9559930515*m} y { -2853.51581870475*m}
create vertex x { 29665.6050955414*m} y { -2859.46642864227*m}
create vertex x { 30472.0613781123*m} y { -2894.77338093821*m}
create vertex x { 31006.2246670527*m} y { -2925.71655261331*m}
create vertex x { 32056.3115228720*m} y { -2983.23911534266*m}
create vertex x { 32570.9322524609*m} y { -3012.19875037191*m}
create vertex x { 33897.2206137811*m} y { -3053.45631260538*m}
create vertex x { 34805.2982049797*m} y { -3086.38302092631*m}
create vertex x { 36605.8193398958*m} y { -3098.68094813052*m}
create vertex x { 39233.6421540243*m} y { -3123.67350986810*m}
create vertex x { 45000*m} y { -3156.60021818903*m}
${idMargabr_r=Id("vertex")}	

create curve vertex {idMargabl_l} to {idMargabl_r}
curve {Id("curve")} name "Marga_bot_left"
create curve spline vertex {idMargabm_l} to {idMargabm_r}
curve {Id("curve")} name "Marga_bot_mid"
create curve spline vertex {idMargabr_l} to {idMargabr_r}
curve {Id("curve")} name "Marga_bot_right"	

################## 	Bot LM1		#######################		
create vertex x { 0*m} y { -4014.67817117921*m}
${idLM1bl_l=Id("vertex")}
create vertex x { 17669.079330*m} y {-4014.678171*m}
${idLM1bl_r=Id("vertex")}
	
create vertex x { 29012.8836132021*m} y { -3757.61182187841*m}
${idLM1br_l=Id("vertex")}
create vertex x { 29307.3248407643*m} y { -3729.44560150749*m}
create vertex x { 29544.4412275622*m} y { -3744.12377268670*m}
create vertex x { 29726.8384481760*m} y { -3770.70316374095*m}
create vertex x { 30207.5854082224*m} y { -3816.32450659526*m}
create vertex x { 31006.2246670527*m} y { -3863.53267876624*m}
create vertex x { 31899.9710480602*m} y { -3902.80670435386*m}
create vertex x { 33342.2119281992*m} y { -3942.08072994149*m}
create vertex x { 34019.6873190504*m} y { -3960.32926708321*m}
create vertex x { 35319.9189345686*m} y { -3980.95804819994*m}
create vertex x { 45000*m} y { -3980.95804819994*m}
${idLM1br_r=Id("vertex")}	
	
create curve vertex {idLM1bl_l} to {idLM1bl_r}
curve {Id("curve")} name "LM1_bot_left"
create curve spline vertex {idLM1br_l} to {idLM1br_r}
curve {Id("curve")} name "LM1_bot_right"

###############                         fault divide ###############################
create vertex x { 15065.360997*m} y {-3214.993297*m}
${idfaultdivbot1=Id("vertex")}
create vertex x { 15112.912570*m} y {-3212.535952*m}
${idfaultdivbot2=Id("vertex")}

create curve vertex {idfaultdiv1} to {idfaultdiv2}
curve {Id("curve")} name "fault_div_bot"

create vertex x {11731.446850*m} y {-547.919750*m}
${idmiotl=Id("vertex")}
create vertex x { 11742.472500*m} y {-547.852822*m}
${idmiotr=Id("vertex")}

create curve vertex {idmiotl} to {idmiotr}
curve {Id("curve")} name "fault_div_miot"

create vertex x {12263.692740*m} y {-1352.787363*m}
${idamphtl_l=Id("vertex")}
create vertex x { 12277.938620*m} y {-1352.375285*m}
${idamphtr_l=Id("vertex")}

create curve vertex {idamphtl_l} to {idamphtr_l}
curve {Id("curve")} name "fault_div_amphbtl"

create vertex x {12372.907893*m} y {-1449.605904*m}
${idamphtl_r=Id("vertex")}
create vertex x {12388.679790*m} y {-1450.279679*m}
${idamphtr_r=Id("vertex")}

create curve vertex {idamphtl_r} to {idamphtr_r}
curve {Id("curve")} name "fault_div_amphbtr"

create vertex x {12790.000000*m} y {-1871.809575*m}
${idamphbl_l=Id("vertex")}
create vertex x {12805.587720*m} y {-1871.665179*m}
${idamphbr_l=Id("vertex")}

create curve vertex {idamphbl_l} to {idamphbr_l}
curve {Id("curve")} name "fault_div_amphbbl"

create vertex x {12904.000000*m} y {-1975.517705*m}
${idamphbl_r=Id("vertex")}
create vertex x {12920.237410*m} y {-1973.544084*m}
${idamphbr_r=Id("vertex")}

create curve vertex {idamphbl_r} to {idamphbr_r}
curve {Id("curve")} name "fault_div_amphbbr"

create vertex x {14556.000000*m} y {-2989.505406*m}
${idmargatl_l=Id("vertex")}
create vertex x { 14586.566300*m} y {-2988.396311*m}
${idmargatr_l=Id("vertex")}

create curve vertex {idmargatl_l} to {idmargatr_l}
curve {Id("curve")} name "fault_div_margatl"


############### 		merge     	###############################
split CTl_fault crossing Mio_top_left Amphb_top_left fault_div_amphbtr  Amphb_bot_left fault_div_amphbbr Marga_top_left Marga_bot_left #LM1_bot_left
#delete free curve CTl_fault@F extramio #CTl_fault@G 
split CT_fault crossing curve Mio_top_mid fault_div_amphbtl Amphb_top_mid fault_div_amphbbl Amphb_bot_mid fault_div_margatl Marga_top_mid fault_div_bot Marga_bot_mid LM1_bot_left S_fault
split S_fault crossing curve Mio_top_mid Mio_top_right Amphb_top_mid Amphb_top_right Amphb_bot_mid Amphb_bot_right Marga_top_mid Marga_top_right Marga_bot_mid Marga_bot_right LM1_bot_right

imprint surface 1 with curve all
Merge Tolerance 0.05
merge all

# delete free vertices
delete free vertex all

#delete free curves 
#delete free curve Mio_top_mid
#delete free curve CT_fault@A
	
###############################		MESH		##########################################
surface all scheme trimesh
surface 2 3 5 13 size 800
#surface 3 5 13 size 500
surface 4 7 16 size 500
surface 6 8 17 18 size 300
surface 9 11 size 150
surface 10 12 14 19 20 size 300
surface 15 size 15
mesh surface all

# improve mesh quality by smoothing
#surface all smooth scheme condition number beta 1.5 cpu 10
#smooth surface all	
	
###############################	 	MATERIAL BLOCKS		##################################
block 1 surface 6 9 17
block 1 element type tri
block 1 name "res_LM2"

block 2 surface 3 5 15
block 2 element type tri
block 2 name "res_LM1"

block 3 surface 4 7 16
block 3 element type tri
block 3 name "Marga"

block 4 surface 8 11 18
block 4 element type tri
block 4 name "Amphb"

block 5 surface 2
block 5 element type tri
block 5 name "older"

block 6 surface 10 12 19
block 6 element type tri
block 6 name "MM_UM"

block 7 surface 13 20
block 7 element type tri
block 7 name "younger"

block 8 surface 14
block 8 element type tri
block 8 name "fault"


###############################	NODESETS FOR FAULT AND BOUNDARIES		###########################

group "topboundary" add node in curve 91 103 115
nodeset 2 group topboundary 
nodeset 2 name "topboundary"

group "leftboundary" add node in curve 56 104 106 108 110 112 114
nodeset 4 group leftboundary 
nodeset 4 name "leftboundary"

group "rightboundary" add node in curve 55 63 67 73 79 85 92
nodeset 5 group rightboundary 
nodeset 5 name "rightboundary"

group "bottomboundary" add node in curve 3
nodeset 6 group bottomboundary 
nodeset 6 name "bottomboundary"

group "fault_CT" add node in curve CT_fault CT_fault@A CT_fault@B CT_fault@C CT_fault@D CT_fault@E CT_fault@F
nodeset 7 group fault_CT
nodeset 7 name "fault_CT"

group "fault_S" add node in curve S_fault@I S_fault@H S_fault@G S_fault@F S_fault@E S_fault@D S_fault@C S_fault@B S_fault@A S_fault
nodeset 8 group fault_S
nodeset 8 name "fault_S"

export mesh "/home/lsalo/2Dgom_mz.exo" dimension 2 overwrite






