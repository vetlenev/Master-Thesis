# Test mesh
reset
${Units('si')}

#################### GEOMETRY#####################################################
############# 	boundaries		##############################
create vertex x { 0*m} y {0*m}
${idtopleft=Id("vertex")}
create vertex x { 5000*m} y {0*m}
${idtopright=Id("vertex")}
create vertex x { 5000*m} y { -1000.0*m}
${idbotright=Id("vertex")}
create vertex x { 0*m} y { -1000.0*m}
${idbotleft=Id("vertex")}

create surface vertex all 

create vertex x {2200*m} y {-400*m}
${idin=Id("vertex")}
create vertex x { 2600*m} y { -400*m}
create vertex x { 2600*m} y { -600*m}
create vertex x { 2200*m} y { -600*m}
#${idfin=Id("vertex")}

create surface vertex {idin} to {idfin}
imprint surface 1 with surface 2
delete body 2
	
###############################		MESH		##########################################
surface all scheme trimesh
surface 3 size 200
surface 4 size 50
mesh surface all

# improve mesh quality by smoothing
#surface all smooth scheme condition number beta 1.5 cpu 10
#smooth surface all	
	
###############################	 	MATERIAL BLOCKS		##################################
block 1 surface all
block 1 element type tri
block 1 name "reservoir"

###############################	       NODESETS FOR FAULT AND BOUNDARIES		###########################

group "topboundary" add node in curve 1
nodeset 2 group topboundary 
nodeset 2 name "topboundary"

group "leftboundary" add node in curve 4
nodeset 4 group leftboundary 
nodeset 4 name "leftboundary"

group "rightboundary" add node in curve 2 
nodeset 5 group rightboundary 
nodeset 5 name "rightboundary"

group "bottomboundary" add node in curve 3
nodeset 6 group bottomboundary 
nodeset 6 name "bottomboundary"

export mesh "/home/lluis/test_mesh.exo" dimension 2 overwrite 









